# SGEMV

## 说明
项目结构
```
.
├── README.md
├── include
│   ├── lib.cuh # 模板实现
│   └── tune.cuh # 自动调优
├── main.py # 测试脚本
├── sgemv.cu # torch 实现
├── tune.cu # 调优示例
└── xmake.lua
```
## 编译运行
编译库文件
```
xmake b sgemv && xmake install
```
运行 python 测试脚本
```
python main.py
```
## 预期结果
```
SGEMV Performance (ms):
         M_K  PyTorch_Matmul  Custom_k32_f32  Custom_k128_f32x4  Custom_Dispatch
0    128_128        0.006409        0.005911           0.006010         0.005854
1   1024_128        0.007593        0.006402           0.006370         0.006249
2   1024_256        0.008466        0.007081           0.006956         0.006471
3   4096_128        0.012066        0.007085           0.007214         0.007048
4   2048_256        0.011850        0.007468           0.007460         0.007143
5   128_1024        0.010193        0.009672           0.007820         0.007840
6   256_1024        0.010288        0.009934           0.008047         0.008065
7  1024_1024        0.023345        0.010691           0.009030         0.008885
```

